<!doctype html>
<html>
<head>
<meta charset="utf-8" />
<title>Psychic Pixels</title> 

<!-- for Apple -->
<!-- found user-scalable=no worked best for full screen auto scaling -->
<meta name="viewport" content="user-scalable=no, minimal-ui" />
<!--<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimal-ui" />--> 
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
<link rel="apple-touch-icon-precomposed" href="url_to_icon_57x57" />

<script>var zon = true; // true for comments from zim code</script>
<script src="http://d309knd7es5f10.cloudfront.net/zim_2.2.js"></script>
<script src="https://code.createjs.com/createjs-2015.11.26.min.js"></script> 
<script src="model.js"></script>
<script src="view.js"></script>
<script src="controller.js"></script>


<style>
	body {margin:0px; padding:0px; background-color:#ddd;}
	#myCanvas {position:absolute; background-color:#ddd;}
	@font-face { 
		font-family: homespun;        
		src: 	url('homespun.eot?#iefix') format('embedded-opentype'),
				url('homespun.ttf') format('truetype');
	}
</style>

<script>
	
// SCALING OPTIONS
// "none"		sets canvas and stage to dimensions and does not scale if window changes
// "fit"		sets canvas and stage to dimensions and scales to fit inside window size
// "outside"	sets canvas and stage to dimensions and scales to fit outside window size
// "full"		sets canvas and stage to window size (canvas is actually set to screen size)

var scaling = "full"; // full automatically sets width and height to window size
var width = null;
var height = null;
var stage, stageW, stageH;

var frame = new zim.Frame(scaling, width, height); 

frame.on("ready", function() {	
	zog("ready from ZIM Frame");
	
	stage = frame.stage;
	stageW = frame.width;
	stageH = frame.height;
	
	var layout = new zim.LayoutManager();
	
	var m = app.makeModel();
	var v = app.makeView(m, layout);
	
	
	var pixel = new zim.Rectangle(25,25, "#666");
	stage.addChild(pixel);
	zim.centerReg(pixel, stage);
	zim.animate(pixel, {rotation:720, alpha:0}, 2000);
	
	// preloading fonts is troublesome
	// so wait a few seconds, animate in and refresh stage a few times 
	var count=0;
	var interval = setInterval(function() {
		count++;
		stage.update();
		if (count == 2) {
			stage.addChild(pages);
			stage.removeChild(pixel);
			v.first.cache(0,0,stageW,stageH);
			v.first.alpha = .0;
			zim.animate(v.first, {alpha:1}, 2000, null, function() {v.first.uncache();});
		} else if (count > 5) {
			clearInterval(interval);
		}
	}, 1000);

	
	var pages = new zim.Pages(stage, [
		// swipe ["right", "left", "down", "up"]
		{page:v.first, swipe:[null,null,null,v.edit]},			
		{page:v.edit, swipe:[null,null,v.first,null]}		
	], "slide", 500);
	pages.swipe.duration = 50;
	pages.swipe.distance = 25;
		
	
	var c = app.makeController(m, v, pages);
	
	
	
	// put resizing code in here (scaling="full" only)
	frame.on("resize", function(e) {
		stageW = frame.width;
		stageH = frame.height;
		
		layout.resize();
		
		stage.update();
	}); // end of resizing
	
	// put orientation change code in here
	frame.on("orientation", function(e) {		
		stage.update();
	}); // end of orientation
	
	stage.update();	
	
}); // end of ready


</script>
</head>

<body>
<!-- canvas with id="myCanvas" is made by zim Frame -->
<div style="font-family:homespun;">h</div><div style="font-family:TRS Million;">h</div>
</body>
</html>